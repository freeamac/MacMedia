{% extends "base.html" %}
{% import "bootstrap5/form.html" as wtf %}

{% block title %}Add New {{ media_str.upper() }} To Music Media Library{% endblock %}

{% block page_content %}
<div class="page-header">
	<h1>Add A New {{ media_str.upper() }} To The Music Media Library</h1>
</div>

<div class="container">
  <form method="post">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
      <div class="row row-cols-auto">
        <div class="col-sm-2">
          <b>Title:</b>
        </div>
        <div class="col">
          {{ form.title }}
        </div>
      </div>
      <div class="row row-cols-auto top10">
        <div class="col-sm-2">
          <b>Main Artist:</b>
        </div>
        <div class="col">
          {{ form.main_artist}}
        </div>
      </div>
      <div class="row top20"></div>
      <hr class="hr-sm" style="width:75%;text-align:left;margin-left:0;height:20">
      {% for additional_artist in form.additional_artists %}
      <div class="row row-cols-auto" id="artist_row_{{ loop.index0 }}">
        <div class="col">
          <b>Particle:</b>
        </div>
        <div class="col">
        <div class="form-group">
          {{ additional_artist.form.additional_artist_particle }} 
        </div>
        </div>
        <div class="col">
          <b>Additional Artist:</b>
        </div>
        <div class="col">
          <div class="form-group">
            {{ additional_artist.form.additional_artist }}
          </div>
        </div>
        <div class="col-sm-1 plus_button_{{ loop.index0 }}">
          <div class="btn-group" role="group">
            <button class="btn btn-success" type="button"  onclick="additional_artist_fields();"> <span class="bi bi-plus" aria-hidden="true"></span> </button>
          </div>
        </div>
      </div>
      {% endfor %}
      <hr class="hr-sm" style="width:75%;text-align:left;margin-left:0">

      <div class="row row-cols-auto top20">
        <div class="col">
          <b>Mixer:</b>
        </div>
        <div class="col">
          {{ form.mixer }}
        </div>
      </div>
      <div class="row row-cols-auto top20">
        <div class="col">
          <b>Classical Comp. 1:</b>
        </div>
        <div class="col">
          {{ form.classical_composer_1 }}
        </div>
      </div>
      <div class="row row-cols-auto">
        <div class="col">
          <b>Classical Comp. 2:</b>
        </div>
        <div class="col">
          {{ form.classical_composer_2 }}
        </div>
      </div>
      <div class="row row-cols-auto top20">
        <div class="col">
          <b>Year Released:</b>
        </div>
        <div class="col">
          {{ form.year }}
        </div>
      </div>
    
      <div class="row row-cols-auto top20">
        <div class="col">
          <input type="submit" name="finish" value="Add Tracks">
        </div>
        <div class="col">
          <input type="submit" name="cancel" value="Cancel">
        </div>
      </div>
    </form>

</div>
{% endblock %}

{% block scripts %}
{{ super() }}
{{ pagedown.include_pagedown() }}

<script nonce="{{ csp_nonce() }}">
  var artist_num = 0;
  function additional_artist_fields() {
 
    artist_num++;
    var previous_button_id = artist_num - 1;
    $('.plus_button_'+previous_button_id).remove();
    if (artist_num > 1) {$('.minus_button_'+previous_button_id).remove()};
    var objTo = document.getElementById('artist_row_'+previous_button_id);
    var divAdditionalArtist = document.createElement("div");
	  divAdditionalArtist.setAttribute("class", "form-group removeclass"+artist_num);
    divAdditionalArtist.innerHTML = '\
    <div class="row row-cols-auto" id="artist_row_'+artist_num+'">\
      <div class="col"><b>Particle:</b></div>\
      <div class="col"><div class="form-group"><input id="additional_artists-'+artist_num+'-additional_artist_particle" maxlength="20" minlength="0" name="additional_artists-'+artist_num+'-additional_artist_particle" type="text" value=""> </div></div>\
      <div class="col"><b>Additional Artist:</b></div>\
      <div class="col"><div class="form-group"><input id="additional_artists-'+artist_num+'-additional_artist" maxlength="40" minlength="0" name="additional_artists-'+artist_num+'-additional_artist" type="text" value=""></div></div>\
      <div class="col-sm-1 plus_button_'+artist_num+'">\
        <div class="btn-group" role="group">\
          <button class="btn btn-success" type="button"  onclick="additional_artist_fields();"> <span class="bi bi-plus" aria-hidden="true"></span> </button>\
        </div>\
      </div>\
      <div class="col-sm-1 minus_button_'+artist_num+'">\
        <div class="btn-group" role="group">\
          <button class="btn btn-danger" type="button" onclick="remove_additional_artist_fields('+ artist_num +');"> <span class="bi bi-dash-lg" aria-hidden="true"></span></button>\
        </div>\
      </div>\
    </div>';
    
    objTo.after(divAdditionalArtist)
  }
  function remove_additional_artist_fields(rid) {
	  $('.removeclass'+rid).remove();
    artist_num = rid - 1;
    var objTo = document.getElementById('artist_row_'+artist_num);
    var plusButton = document.createElement("div");
	  plusButton.setAttribute("class", "col-sm-1 plus_button_"+artist_num);
    plusButton.innerHTML = '\
      <div class="btn-group" role="group">\
        <button class="btn btn-success" type="button"  onclick="additional_artist_fields();"> <span class="bi bi-plus" aria-hidden="true"></span> </button>\
      </div>';
    objTo.appendChild(plusButton);
    if (artist_num != 0) {
      var minusButton = document.createElement("div");
      minusButton.setAttribute("class", "col-sm-1 minus_button_"+artist_num);
      minusButton.innerHTML = '\
        <div class="btn-group" role="group">\
          <button class="btn btn-danger" type="button" onclick="remove_additional_artist_fields('+ artist_num +');"> <span class="bi bi-dash-lg" aria-hidden="true"></span></button>\
        </div>';
      plusButton.after(minusButton);
    };
  }
</script>
{% endblock %}
